name: RDP Only Minimal Setup

on:
  workflow_dispatch:

jobs:
  run-rdp:
    runs-on: windows-latest

    steps:
    - name: Change RDP password
      run: |
        $password = "Admin@$(Get-Random -Minimum 1000 -Maximum 9999)"
        net user runneradmin $password
        echo "üîê New RDP password: $password"

    - name: Start Playit tunnel
      run: |
        iwr -Uri https://playit-cloud.github.io/Windows/Playit.exe -OutFile playit.exe
        Start-Process ".\playit.exe" -ArgumentList "authtoken=${{ secrets.PLAYIT_AUTH }}" -NoNewWindow

    - name: Keep alive
      run: Start-Sleep -Seconds 3600
